<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Priyanshu's Galaxy ‚Äî For Ria ‚ú®</title>
  <style>
    :root{
      --bg:#020414;
      --accent:#84f1ff;
      --soft:#9bd3ff;
      --rose:#ff6b9a;
      --glass: rgba(255,255,255,0.06);
      --glass-2: rgba(255,255,255,0.04);
      --card-shadow: 0 8px 30px rgba(0,0,0,0.6);
      --radius:18px;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }
    html,body{height:100%;margin:0;background:var(--bg);color:#eaf6ff;overflow:hidden}
    /* full-canvas star background */
    #spaceCanvas{position:fixed;inset:0;z-index:0}

    /* center UI */
    .ui{
      position:relative;z-index:10;display:grid;grid-template-columns: 430px 1fr;gap:28px;padding:36px;align-items:start;height:100vh;box-sizing:border-box;
    }

    /* left panel */
    .card{
      backdrop-filter: blur(8px) saturate(1.05);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:var(--radius);box-shadow:var(--card-shadow);padding:20px;
    }
    header h1{font-size:20px;margin:0 0 6px 0}
    header p{margin:0;color:rgba(255,255,255,0.65);font-size:13px}

    .logo{display:flex;gap:12px;align-items:center}
    .logo .badge{width:54px;height:54px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--rose));display:flex;align-items:center;justify-content:center;font-weight:700}

    /* game buttons */
    .controls{margin-top:16px;display:flex;flex-direction:column;gap:10px}
    .btn{background:linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06)}
    .small{padding:8px 10px;font-size:14px}

    /* right area */
    .stage{height:calc(100vh - 72px);display:flex;flex-direction:column;gap:14px}
    .panel{flex:1;border-radius:16px;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow:var(--card-shadow);overflow:auto}

    /* starfield area */
    #starfield{position:relative;height:100%;display:flex;align-items:center;justify-content:center}
    #playArea{width:100%;height:100%;position:relative}

    /* messages */
    .messageBox{position:absolute;left:20px;bottom:20px;padding:12px 14px;border-radius:12px;background:linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.35));border:1px solid rgba(255,255,255,0.04)}

    /* love meter */
    .meterWrap{display:flex;align-items:center;gap:12px}
    input[type=range]{width:100%}
    .meterVal{min-width:60px;text-align:center}

    /* quiz */
    .quiz qItem{display:block}
    .quiz .opt{display:block;margin:8px 0}

    /* rocket */
    .rocket{position:absolute;right:40px;bottom:40px;width:84px;height:84px;transform-origin:50% 100%;transition:transform 1.2s cubic-bezier(.2,.9,.3,1)}
    .rocket svg{width:100%;height:100%}
    .launching{animation:launch 2.6s ease forwards}
    @keyframes launch{0%{transform:translateY(0) scale(1) rotate(0)}60%{transform:translateY(-48vh) scale(1.05) rotate(4deg)}100%{transform:translateY(-120vh) scale(0.6) rotate(10deg);opacity:0}}

    /* typewriter */
    .typewriter{font-family:monospace;background:transparent;border-left:2px solid rgba(255,255,255,0.08);padding-left:8px}

    /* final modal */
    .finalModal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.85));z-index:40;backdrop-filter: blur(6px);visibility:hidden;opacity:0;transition:opacity .35s}
    .finalModal.show{visibility:visible;opacity:1}
    .finalCard{width:720px;max-width:94%;padding:28px;border-radius:20px;background:linear-gradient(180deg, rgba(8,6,20,0.9), rgba(12,8,30,0.95));border:1px solid rgba(255,255,255,0.04);text-align:center}
    .finalCard h2{font-size:28px;margin-bottom:8px}
    .finalCard p{color:rgba(255,255,255,0.78);line-height:1.4}
    .final-actions{display:flex;gap:12px;justify-content:center;margin-top:18px}
    .final-actions .btn{padding:12px 18px;border-radius:12px}

    /* responsive */
    @media (max-width:980px){
      .ui{grid-template-columns:1fr;padding:18px;gap:12px}
      .logo .badge{width:44px;height:44px}
      .rocket{display:none}
    }

    /* fun little twinkle on found star */
    .foundStar{position:absolute;padding:8px 12px;background:linear-gradient(90deg,var(--accent),var(--rose));border-radius:999px;color:#051017;font-weight:700;font-size:13px;transform:translate(-50%,-160%);pointer-events:none}
  </style>
</head>
<body>
  <canvas id="spaceCanvas"></canvas>

  <div class="ui">
    <div class="card">
      <div class="logo">
        <div class="badge">P</div>
        <div>
          <header>
            <h1>Priyanshu's Galaxy</h1>
            <p>For Ria ‚Äî a starry cinematic proposal</p>
          </header>
          <div style="margin-top:10px;font-size:13px;color:rgba(255,255,255,0.7)">Tip: Type <strong>ria</strong> anywhere to reveal a secret letter ‚ú®</div>
        </div>
      </div>

      <div class="controls">
        <button class="btn" id="btnFindStar">Find Ria's Star ‚≠ê</button>
        <button class="btn" id="btnQuiz">Mini Quiz: About Ria</button>
        <button class="btn" id="btnLaunch">Mission to Ria (Launch Rocket)</button>
        <button class="btn ghost small" id="btnLetter">Open Secret Letter</button>
      </div>

      <div style="margin-top:16px">
        <div style="font-size:13px;color:rgba(255,255,255,0.65);margin-bottom:8px">Love Meter</div>
        <div class="meterWrap">
          <input type="range" id="loveRange" min="0" max="100" value="70">
          <div class="meterVal" id="loveVal">70%</div>
        </div>
      </div>

      <div style="margin-top:14px;font-size:13px;color:rgba(255,255,255,0.75)">
        <div><strong>Short Tasks</strong></div>
        <ul style="margin:8px 0 0 20px;color:rgba(255,255,255,0.7)">
          <li>Click a glowing star to leave a message</li>
          <li>Answer quiz to unlock final scene</li>
          <li>Drag the love meter to 100% for a surprise</li>
        </ul>
      </div>

      <div style="margin-top:18px;font-size:12px;color:rgba(255,255,255,0.6)">Made with ‚ô• by Priyanshu ‚Äî Customize the poem inside the secret letter.</div>

    </div>

    <div class="stage">
      <div class="panel" id="starfield">
        <div id="playArea">
          <!-- dynamic stars overlayed -->
          <div class="messageBox" id="log">Welcome, Priyanshu. Guide Ria through the stars ‚ú®</div>
          <div id="foundMsg" class="foundStar" style="display:none">You found my heart ‚ù§Ô∏è</div>
          <div class="rocket" id="rocket" title="Launch to Ria">
            <svg viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g>
                <path d="M32 2c0 0-10 8-14 18-3 8 2 18 2 18s10-3 18-11S32 2 32 2z" fill="url(#g1)" />
                <path d="M25 42c-2 5 2 8 2 8s5 1 10-6c-6 0-10-2-12-2z" fill="#ffb3c7" />
                <defs>
                  <linearGradient id="g1" x1="0" x2="1">
                    <stop offset="0" stop-color="#84f1ff" />
                    <stop offset="1" stop-color="#ff6b9a" />
                  </linearGradient>
                </defs>
              </g>
            </svg>
          </div>
        </div>
      </div>

      <div class="panel" style="display:flex;flex-direction:column;gap:12px">
        <div style="display:flex;gap:12px;align-items:center;justify-content:space-between">
          <div class="typewriter" id="typewriter">Loading message...</div>
          <div style="display:flex;gap:8px;align-items:center">
            <button class="btn small" id="btnFinal">Show Final Proposal</button>
            <button class="btn small ghost" id="btnReset">Reset</button>
          </div>
        </div>

        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="flex:1">
            <div style="font-size:14px;margin-bottom:8px">Mini Quiz</div>
            <div id="quizArea" style="background:var(--glass);padding:12px;border-radius:10px;min-height:120px">
              <div id="quizQ">Press "Mini Quiz" to start</div>
            </div>
          </div>

          <div style="width:220px">
            <div style="font-size:14px;margin-bottom:8px">Short Log</div>
            <div style="background:var(--glass-2);padding:10px;border-radius:10px;min-height:120px;font-size:13px;color:rgba(255,255,255,0.8)" id="miniLog">
              Actions will appear here
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- final modal -->
  <div class="finalModal" id="finalModal">
    <div class="finalCard">
      <h2>Ria, will you be my forever star?</h2>
      <p id="finalPoem"> </p>
      <div class="final-actions">
        <button class="btn" id="yesBtn">Yes ‚Äî I'll be yours ‚ú®</button>
        <button class="btn ghost" id="noBtn">Wait... (prank)</button>
      </div>
    </div>
  </div>

  <!-- secret letter modal -->
  <div class="finalModal" id="letterModal">
    <div class="finalCard">
      <h2>A secret letter for Ria</h2>
      <p style="text-align:left;white-space:pre-wrap;color:rgba(255,255,255,0.85)" id="secretLetter">

      </p>
      <div style="margin-top:16px;text-align:center">
        <button class="btn" id="closeLetter">Close</button>
      </div>
    </div>
  </div>

  <script>
    // ---------- Utilities ----------
    const $ = (s) => document.querySelector(s);
    const spaceCanvas = $('#spaceCanvas');
    const ctx = spaceCanvas.getContext('2d');
    let w=spaceCanvas.width=innerWidth, h=spaceCanvas.height=innerHeight;

    // ---------- Starfield with twinkle ----------
    const stars = [];
    function rand(a,b){return a+Math.random()*(b-a)}
    function initStars(){
      stars.length=0;
      const count = Math.round((w*h)/6000);
      for(let i=0;i<count;i++){
        stars.push({x:Math.random()*w,y:Math.random()*h,r:Math.random()*1.6+0.2,alpha:Math.random(),dAlpha:Math.random()*0.02+0.002,glow:Math.random()>0.96?true:false})
      }
    }
    function drawStars(){
      ctx.clearRect(0,0,w,h);
      // subtle gradient background
      const g=ctx.createLinearGradient(0,0,0,h);
      g.addColorStop(0,'#00030a');g.addColorStop(1,'#050517');
      ctx.fillStyle=g;ctx.fillRect(0,0,w,h);
      // small nebula
      const ng = ctx.createRadialGradient(w*0.75,h*0.22,10,w*0.75,h*0.22,600);
      ng.addColorStop(0,'rgba(132,241,255,0.06)');ng.addColorStop(1,'rgba(0,0,0,0)');
      ctx.fillStyle=ng;ctx.fillRect(0,0,w,h);

      for(let s of stars){
        s.alpha += s.dAlpha*(Math.random()>0.5?1:-1);
        if(s.alpha<0.12) s.alpha=0.12;
        if(s.alpha>1) s.alpha=1;
        ctx.beginPath();
        if(s.glow){
          // glow
          const gg = ctx.createRadialGradient(s.x,s.y,0,s.x,s.y,12);
          gg.addColorStop(0,'rgba(255,255,255,'+(0.8*s.alpha)+')');
          gg.addColorStop(1,'rgba(132,241,255,'+(0.02*s.alpha)+')');
          ctx.fillStyle=gg;ctx.arc(s.x,s.y,6,0,Math.PI*2);ctx.fill();
        }
        ctx.fillStyle='rgba(255,255,255,'+s.alpha+')';
        ctx.arc(s.x,s.y,s.r,0,Math.PI*2);ctx.fill();
      }
    }
    function animate(){
      drawStars();
      requestAnimationFrame(animate);
    }
    onresize = ()=>{w=spaceCanvas.width=innerWidth;h=spaceCanvas.height=innerHeight;initStars();}
    initStars();animate();

    // ---------- Play area interactive stars ----------
    const playArea = document.getElementById('playArea');
    const foundMsg = document.getElementById('foundMsg');
    const miniLog = document.getElementById('miniLog');
    const log = document.getElementById('log');

    function addFloatingStar(x,y,id){
      const el = document.createElement('div');
      el.className='floatingStar';
      el.style.position='absolute';el.style.left=(x-6)+'px';el.style.top=(y-6)+'px';
      el.style.width='12px';el.style.height='12px';el.style.borderRadius='50%';
      el.style.boxShadow='0 0 8px 3px rgba(132,241,255,0.12), inset 0 0 6px rgba(255,255,255,0.7)';
      el.style.cursor='pointer';el.dataset.id=id;
      playArea.appendChild(el);
      el.addEventListener('click',()=>{
        // show found message near star
        foundMsg.style.left=(x)+'px';foundMsg.style.top=(y)+'px';foundMsg.style.display='block';
        setTimeout(()=>foundMsg.style.display='none',2200);
        miniLog.innerText = 'You clicked a glowing star ‚Äî message sent ‚ù§Ô∏è';
        log.innerText = 'You found a star at ('+Math.round(x)+', '+Math.round(y)+')';
      });
      // gentle float
      let dir = Math.random()>0.5?1:-1;let t=0;
      function float(){t+=0.02;el.style.transform='translateY('+Math.sin(t*2+id)*6+'px)';requestAnimationFrame(float)}
      float();
    }

    // generate interactive stars
    function generateInteractiveStars(n=16){
      // clear old
      document.querySelectorAll('.floatingStar').forEach(e=>e.remove());
      for(let i=0;i<n;i++){
        const x = Math.random()*(playArea.clientWidth-80)+40;
        const y = Math.random()*(playArea.clientHeight-120)+40;
        addFloatingStar(x,y,i);
      }
    }
    // initial
    setTimeout(()=>generateInteractiveStars(18),600);

    // ---------- Love Meter ----------
    const loveRange = $('#loveRange');
    const loveVal = $('#loveVal');
    loveRange.addEventListener('input',()=>{loveVal.innerText = loveRange.value + '%';if(loveRange.value==100){miniLog.innerText='Love Meter at 100%! A special surprise unlocked.';document.getElementById('btnFinal').classList.add('highlight');}}
    );

    // ---------- Typewriter messages ----------
    const tw = $('#typewriter');
    const messages = [
      "Ria ‚Äî every star reminds me of you.",
      "I made this little galaxy just for you.",
      "Click the stars, answer the quiz, and join me among the constellations.",
      "When you say 'yes', my universe becomes complete."
    ];
    let mi=0;let tpos=0;let typing=true;
    function startType(){
      tw.innerText='';tpos=0;typing=true;typeChar();
    }
    function typeChar(){
      if(!typing) return;
      const cur = messages[mi];
      if(tpos<=cur.length){tw.innerText = cur.slice(0,tpos);tpos++;setTimeout(typeChar,40+Math.random()*40)}else{typing=false;setTimeout(()=>{mi=(mi+1)%messages.length;typing=true;tpos=0;typeChar()},2200)}
    }
    startType();

    // ---------- Mini Quiz ----------
    const quizQ = $('#quizQ');
    const quizData = [
      {q:"Where did we first meet?",opts:["College","Cafe","Online","Under the stars"],a:3},
      {q:"What is Ria's favorite thing?",opts:["Mountains","Space & Stars","Chocolate","Rain"],a:1},
      {q:"What do I dream to do with Ria?",opts:["Travel the world","Build a home","Watch a thousand sunsets","All of these"],a:3}
    ];
    let qIndex=0;let score=0;
    $('#btnQuiz').addEventListener('click',()=>{
      score=0;qIndex=0;renderQ();miniLog.innerText='Quiz started ‚Äî good luck!';
    });
    function renderQ(){
      const q = quizData[qIndex];
      quizQ.innerHTML = '<div style="font-weight:700;margin-bottom:8px">Q'+(qIndex+1)+'. '+q.q+'</div>' +
        q.opts.map((o,i)=>`<button class="btn small" onclick="answer(${i})" style="display:block;margin:6px 0;border-radius:10px;text-align:left">${String.fromCharCode(65+i)}. ${o}</button>`).join('');
    }
    window.answer = function(i){
      const q = quizData[qIndex];
      if(i===q.a){score++;miniLog.innerText='Nice! Correct.';}else{miniLog.innerText='Oh! That one was tricky.'}
      qIndex++;
      if(qIndex<quizData.length){renderQ();}else{quizQ.innerHTML = '<div style="font-weight:700">Quiz complete!</div><div style="margin-top:8px">Score: '+score+' / '+quizData.length+'</div>';
        log.innerText = 'Quiz finished ‚Äî score '+score+'/'+quizData.length;
        if(score>=2){miniLog.innerText='You unlocked the final proposal! Click "Show Final Proposal"';}
      }
    }

    // ---------- Launch Rocket ----------
    const rocket = $('#rocket');
    $('#btnLaunch').addEventListener('click',()=>{
      rocket.classList.remove('launching');void rocket.offsetWidth;rocket.classList.add('launching');miniLog.innerText='Launching mission to Ria... üöÄ';
      setTimeout(()=>miniLog.innerText='Rocket reached orbit ‚Äî message delivered to Ria ‚ù§Ô∏è',2600);
    });
    rocket.addEventListener('click',()=>{document.getElementById('btnLaunch').click();});

    // ---------- Find Ria's Star ----------
    $('#btnFindStar').addEventListener('click',()=>{
      miniLog.innerText='Looking for Ria\'s star...';
      // animate stars regenerate and highlight one
      const fs = document.querySelectorAll('.floatingStar');
      const pick = fs[Math.floor(Math.random()*fs.length)];
      if(pick){
        pick.click();
        const rc = pick.getBoundingClientRect();
        foundMsg.style.left=(rc.left+rc.width/2)+'px';foundMsg.style.top=(rc.top+rc.height/2)+'px';foundMsg.style.display='block';
        setTimeout(()=>foundMsg.style.display='none',2200);
      }
    });

    // ---------- Secret Letter (typing 'ria') ----------
    let keySeq = '';
    const secret = `My dearest Ria,\n\nFrom the moment I first saw your smile I knew my nights would look different‚Äîfull of stars and soft light. This little galaxy I built for you has one simple question at its center: will you be my forever?\n\nAll my love,\nPriyanshu ‚ú®`;
    $('#btnLetter').addEventListener('click',openLetter);
    document.addEventListener('keydown',(e)=>{
      keySeq += e.key.toLowerCase(); if(keySeq.length>6) keySeq=keySeq.slice(-6);
      if(keySeq.includes('ria')){openLetter();keySeq='';}
    });
    function openLetter(){
      $('#secretLetter').innerText = secret;$('#letterModal').classList.add('show');log.innerText='Secret letter opened';miniLog.innerText='A soft letter appears...';
    }
    $('#closeLetter').addEventListener('click',()=>{$('#letterModal').classList.remove('show');});

    // ---------- Final Proposal ----------
    const finalModal = $('#finalModal');
    const finalPoem = $('#finalPoem');
    const poem = `Ria ‚Äî\n\nAmong a thousand stars, I chose you.\nEvery little light in this sky whispers your name.\nIf you say yes, I promise to make every night feel like this ‚Äî warm, bright and ours.\n\nSay you'll be my forever star. üåü‚ù§Ô∏è`;
    $('#btnFinal').addEventListener('click',()=>{finalPoem.innerText = poem;finalModal.classList.add('show');miniLog.innerText='Final scene ‚Äî your proposal is ready.'});
    $('#yesBtn').addEventListener('click',()=>{finalModal.querySelector('h2').innerText='She said YES ‚ú®üíç';finalModal.querySelector('p').innerText='Thank you, Ria. Welcome to our forever.';miniLog.innerText='SHE SAID YES! Congratulations üåü';});
    $('#noBtn').addEventListener('click',()=>{finalModal.classList.remove('show');miniLog.innerText='A playful prank ‚Äî try again?';});

    // ---------- Reset ----------
    $('#btnReset').addEventListener('click',()=>{document.querySelectorAll('.floatingStar').forEach(e=>e.remove());generateInteractiveStars(18);miniLog.innerText='Reset the stars.';log.innerText='Galaxy reset.'});

    // ---------- Small helper: regenerate stars on click area resize ----------
    let resizeTO;new ResizeObserver(()=>{clearTimeout(resizeTO);resizeTO=setTimeout(()=>generateInteractiveStars(18),200)}).observe(playArea);

    // ---------- Ambient synth (simple) ----------
    try{
      const audioCtx = new (window.AudioContext||window.webkitAudioContext)();
      const master = audioCtx.createGain();master.gain.value=0.07;master.connect(audioCtx.destination);
      function playNote(freq,dur,when){const o=audioCtx.createOscillator();const g=audioCtx.createGain();o.type='sine';o.frequency.value=freq;g.gain.setValueAtTime(0.0001,when);g.gain.linearRampToValueAtTime(0.6,when+0.02);g.gain.exponentialRampToValueAtTime(0.001,when+dur);o.connect(g);g.connect(master);o.start(when);o.stop(when+dur+0.02)}
      function ambient(){const now=audioCtx.currentTime;playNote(220+Math.random()*120,1.6,now);setTimeout(ambient,1800+Math.random()*2200)}
      // start on user gesture
      const startAudio = ()=>{if(audioCtx.state!=='running') audioCtx.resume();ambient();document.removeEventListener('click',startAudio)};
      document.addEventListener('click',startAudio);
    }catch(e){console.warn('Audio not allowed',e)}

    // ---------- Small startup log ----------
    miniLog.innerText='Galaxy initialized. Click anywhere to wake the music.';

  </script>
</body>
</html>
